# PRISM Preference Tracer - Logging Guide

## æ¦‚è¿°

PRISM Preference Tracer ç°åœ¨æ”¯æŒè¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼Œå±•ç¤ºæ¯ä¸€æ­¥çš„å¤„ç†è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ï¼š

- ğŸ¯ **åˆå§‹åŒ–å‡è®¾**ï¼šé¦–æ¬¡ç”Ÿæˆç”¨æˆ·åå¥½å‡è®¾
- ğŸ”„ **ä¼ æ’­å‡è®¾**ï¼šåŸºäºæ–°å¯¹è¯æ›´æ–°å‡è®¾
- âš–ï¸ **åŠ æƒå‡è®¾**ï¼šæ ¹æ®ç”¨æˆ·é€‰æ‹©è¯„ä¼°æ¯ä¸ªå‡è®¾çš„å¯èƒ½æ€§
- ğŸ“Š **é‡é‡‡æ ·/Rejuvenate**ï¼šç»´æŒå‡è®¾å¤šæ ·æ€§
- ğŸ“ **ç”¨æˆ·ç”»åƒæ€»ç»“**ï¼šæ±‡æ€»åŠ æƒå‡è®¾
- âœ… **è¯„ä¼°ç»“æœ**ï¼šç”Ÿæˆè´¨é‡å’Œé¢„æµ‹å‡†ç¡®ç‡

## å¯ç”¨æ—¥å¿—

### æ–¹æ³• 1: å‘½ä»¤è¡Œå‚æ•°

```bash
python run_prism_pipeline.py \
    --stage trace \
    --n-users 2 \
    --n-hypotheses 3 \
    --print \
    --run-id demo
```

**å‚æ•°è¯´æ˜**ï¼š
- `--print`: å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼ˆå½©è‰²æ ¼å¼ï¼‰
- `--save-detailed-traces`: æ¯ä¸ªç”¨æˆ·ä¿å­˜å•ç‹¬çš„è¯¦ç»†è¿½è¸ªæ–‡ä»¶

### æ–¹æ³• 2: é…ç½®æ–‡ä»¶

åœ¨ `configs.yaml` ä¸­è®¾ç½® `print: true`ï¼š

```yaml
quick_test_verbose:
  tracing_model: "gpt-4o-mini"
  n_hypotheses: 3
  n_users: 2
  print: true
  save_detailed_traces: true
```

ç„¶åè¿è¡Œï¼š
```bash
python batch_runner.py --experiments quick_test_verbose
```

### æ–¹æ³• 3: æ¼”ç¤ºè„šæœ¬

æœ€ç®€å•çš„æ–¹å¼ï¼Œè¿è¡Œé¢„é…ç½®çš„æ¼”ç¤ºï¼š

```bash
python demo_logging.py
```

æˆ–æŒ‡å®šç”¨æˆ·æ•°ï¼š
```bash
python demo_logging.py --n-users 3 --n-hypotheses 4
```

## æ—¥å¿—è¾“å‡ºç¤ºä¾‹

### 1. ç”¨æˆ·è¿½è¸ªå¼€å§‹
```
======================================================================
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ >>> Tracing preferences for user: u12345                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
======================================================================
```

### 2. å½“å‰è½®æ¬¡ä¿¡æ¯
```
======================================================================
Turn 0: Processing conversation
======================================================================

â”Œâ”€ User Message â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ im redoing a task i completed yesterday! is that fair?          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Chosen Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ no                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. åˆå§‹åŒ–å‡è®¾
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Initializing hypotheses for user u12345                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€ Initial Hypotheses â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. User prefers direct, concise responses without explanation   â”‚
â”‚ 2. User values factual accuracy over politeness                 â”‚
â”‚ 3. User appreciates straightforward communication style         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. ä¼ æ’­å‡è®¾
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Propagating hypotheses...                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 5. åŠ æƒå‡è®¾
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Weighing hypotheses based on user choice...                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Hypothesis Weights:

â”Œâ”€ Hypothesis 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User prefers direct, concise responses without explanation      â”‚
â”‚                                                                  â”‚
â”‚ Raw Score: 2.500 | Weight: 0.487                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Hypothesis 2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User values factual accuracy over politeness                    â”‚
â”‚                                                                  â”‚
â”‚ Raw Score: 2.000 | Weight: 0.295                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Hypothesis 3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User appreciates straightforward communication style            â”‚
â”‚                                                                  â”‚
â”‚ Raw Score: 2.000 | Weight: 0.295                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6. é‡é‡‡æ ·ï¼ˆå¦‚æœ ESS å¤ªä½ï¼‰
```
â”Œâ”€ Resampling Hypotheses â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ESS: 1.85                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7. Rejuvenateï¼ˆå¦‚æœæ–‡æœ¬å¤šæ ·æ€§å¤ªä½ï¼‰
```
â”Œâ”€ Low Variance Hypotheses â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Text diversity: 0.142                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Low Variance Hypotheses â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User prefers concise and direct answers                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8. ç”¨æˆ·ç”»åƒæ€»ç»“
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ User Preference Profile Summary                                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ This user demonstrates a strong preference for brevity and direct-â•‘
â•‘ ness in communication. They value responses that are to-the-point â•‘
â•‘ and factual, showing little interest in elaboration or politeness.â•‘
â•‘ The user appears to prioritize efficiency and clarity, preferring â•‘
â•‘ straightforward answers without additional context or explanation. â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 9. è½®æ¬¡ç»“æœ
```
Turn 0 Results:
  Gen Score: 0.820
  Prediction: âœ“ (predicted: 3, actual: 3)
  ESS: 2.45
  Text Diversity: 0.387
```

### 10. å®Œæˆè¿½è¸ª
```
======================================================================
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ âœ“ Completed tracing for user u12345                               â•‘
â•‘ Total turns: 3                                                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
======================================================================
```

## è¾“å‡ºæ–‡ä»¶

### å¯ç”¨ `--print` æ—¶

**ç»ˆç«¯è¾“å‡º**ï¼šå½©è‰²çš„å®æ—¶æ—¥å¿—ï¼Œæ˜¾ç¤ºæ‰€æœ‰å¤„ç†æ­¥éª¤

**æ–‡ä»¶è¾“å‡º**ï¼ˆä»ç„¶ä¿å­˜ï¼‰ï¼š
- `preference_results/preference_tracing_results_{run_id}.json` - æ‰€æœ‰ç”¨æˆ·çš„ç»“æœ
- `preference_results/preference_tracing_summary_{run_id}.json` - ç»Ÿè®¡æ‘˜è¦

### å¯ç”¨ `--save-detailed-traces` æ—¶

**é¢å¤–æ–‡ä»¶**ï¼ˆæ¯ä¸ªç”¨æˆ·å•ç‹¬ä¿å­˜ï¼‰ï¼š
- `preference_results/detailed_trace_{user_id}_{run_id}.json`

åŒ…å«ï¼š
```json
{
  "user_id": "u12345",
  "turn_results": [
    {
      "turn": 0,
      "user_profile": "...",
      "gen_score": 0.82,
      "prediction_correct": true,
      "hypotheses": ["h1", "h2", "h3"],
      "weights": [0.487, 0.295, 0.218],
      "ess": 2.45,
      "text_diversity": 0.387
    }
  ],
  "detailed_hypotheses": [
    {
      "target_agent": "u12345",
      "contexts": [...],
      "perceptions": [...],
      "texts": ["h1", "h2", "h3"],
      "weights": [0.487, 0.295, 0.218],
      "previous_ess": 2.45
    }
  ]
}
```

## æ—¥å¿—ä¿¡æ¯è¯´æ˜

### é¢œè‰²ç¼–ç 
- ğŸ”µ **è“è‰²**ï¼šç”¨æˆ·è¿½è¸ªå¼€å§‹/å®Œæˆ
- ğŸŸ¡ **é»„è‰²**ï¼šä¼ æ’­å‡è®¾ã€é‡é‡‡æ ·
- ğŸŸ£ **ç´«è‰²**ï¼šåŠ æƒå‡è®¾
- ğŸŸ¢ **ç»¿è‰²**ï¼šåˆå§‹åŒ–ã€æ€»ç»“ã€æˆåŠŸ
- ğŸ”´ **çº¢è‰²**ï¼šRejuvenateï¼ˆä½å¤šæ ·æ€§ï¼‰

### å…³é”®æŒ‡æ ‡

**ESS (Effective Sample Size)**ï¼š
- èŒƒå›´ï¼š1 åˆ° n_hypotheses
- é«˜å€¼ï¼ˆæ¥è¿‘ nï¼‰ï¼šæƒé‡å‡åŒ€åˆ†å¸ƒï¼Œå‡è®¾å¤šæ ·æ€§å¥½
- ä½å€¼ï¼ˆæ¥è¿‘ 1ï¼‰ï¼šå•ä¸ªå‡è®¾ä¸»å¯¼ï¼Œéœ€è¦é‡é‡‡æ ·
- **è§¦å‘é‡é‡‡æ ·é˜ˆå€¼**ï¼šESS < n_hypotheses / 2

**Text Diversityï¼ˆæ–‡æœ¬å¤šæ ·æ€§ï¼‰**ï¼š
- èŒƒå›´ï¼š0 åˆ° 1
- è®¡ç®—ï¼š1 - Jaccardç›¸ä¼¼åº¦
- é«˜å€¼ï¼šå‡è®¾è¡¨è¿°å·®å¼‚å¤§
- ä½å€¼ï¼šå‡è®¾è¡¨è¿°å¤ªç›¸ä¼¼
- **è§¦å‘ rejuvenate é˜ˆå€¼**ï¼š< 0.25

**Gen Scoreï¼ˆç”Ÿæˆè´¨é‡ï¼‰**ï¼š
- èŒƒå›´ï¼š0 åˆ° 1
- åŸºäºç”¨æˆ·ç”»åƒç”Ÿæˆçš„å›å¤ä¸å®é™…é€‰æ‹©çš„ç›¸ä¼¼åº¦

**Predictionï¼ˆé¢„æµ‹å‡†ç¡®ç‡ï¼‰**ï¼š
- âœ“ï¼šæ­£ç¡®é¢„æµ‹ç”¨æˆ·é€‰æ‹©
- âœ—ï¼šé¢„æµ‹é”™è¯¯

## ä½¿ç”¨åœºæ™¯

### è°ƒè¯•å’Œå¼€å‘
```bash
# å•ç”¨æˆ·è¯¦ç»†è¿½è¸ª
python run_prism_pipeline.py \
    --stage trace \
    --n-users 1 \
    --n-hypotheses 4 \
    --print \
    --save-detailed-traces \
    --run-id debug
```

### ç†è§£ç®—æ³•è¡Œä¸º
```bash
# è§‚å¯Ÿä¸åŒå‡è®¾æ•°é‡çš„å½±å“
python demo_logging.py --n-hypotheses 2  # å°‘å‡è®¾
python demo_logging.py --n-hypotheses 6  # å¤šå‡è®¾
```

### æ¼”ç¤ºå±•ç¤º
```bash
# è¿è¡Œé¢„é…ç½®çš„æ¼”ç¤º
python demo_logging.py
```

### æ‰¹é‡å®éªŒï¼ˆæ— æ—¥å¿—ï¼‰
```bash
# å¤§è§„æ¨¡è¿è¡Œä¸å¼€å¯ printï¼ˆé¿å…è¾“å‡ºè¿‡å¤šï¼‰
python run_prism_pipeline.py \
    --stage all \
    --n-users 50 \
    --run-id large_exp
    # ä¸åŠ  --print
```

## æ€§èƒ½è€ƒè™‘

- **å¯ç”¨ `--print`**ï¼šç»ˆç«¯è¾“å‡ºä¸ä¼šæ˜¾è‘—å½±å“æ€§èƒ½ï¼Œåªæ˜¯æ›´å¤š I/O
- **å¯ç”¨ `--save-detailed-traces`**ï¼šæ¯ä¸ªç”¨æˆ·é¢å¤–å†™ä¸€ä¸ª JSON æ–‡ä»¶
- **å»ºè®®**ï¼š
  - è°ƒè¯•/æ¼”ç¤ºï¼šå¼€å¯ `--print` å’Œ `--save-detailed-traces`
  - å°è§„æ¨¡å®éªŒï¼ˆ< 10 ç”¨æˆ·ï¼‰ï¼šå¼€å¯ `--print`
  - å¤§è§„æ¨¡å®éªŒï¼ˆ> 20 ç”¨æˆ·ï¼‰ï¼šå…³é—­ `--print`ï¼Œå¯é€‰ `--save-detailed-traces`

## æ—¥å¿—åˆ†æ

### æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„è¯¦ç»†è¿½è¸ª
```bash
# å¦‚æœå¯ç”¨äº† --save-detailed-traces
cat preference_results/detailed_trace_u12345_demo.json | jq
```

### æå–å…³é”®ä¿¡æ¯
```python
import json

# è¯»å–è¯¦ç»†è¿½è¸ª
with open('preference_results/detailed_trace_u12345_demo.json', 'r') as f:
    trace = json.load(f)

# æŸ¥çœ‹æ¯è½®çš„å‡è®¾æ¼”åŒ–
for turn in trace['turn_results']:
    print(f"Turn {turn['turn']}:")
    for i, (h, w) in enumerate(zip(turn['hypotheses'], turn['weights'])):
        print(f"  {i+1}. [{w:.3f}] {h}")
    print()
```

## æ•…éšœæ’é™¤

### æ—¥å¿—ä¸æ˜¾ç¤º
- ç¡®è®¤ä½¿ç”¨äº† `--print` å‚æ•°
- æ£€æŸ¥æ˜¯å¦å®‰è£…äº† `rich` åŒ…ï¼š`pip install rich`

### é¢œè‰²ä¸æ˜¾ç¤º
- æŸäº›ç»ˆç«¯ä¸æ”¯æŒå½©è‰²è¾“å‡º
- å°è¯•è®¾ç½®ç¯å¢ƒå˜é‡ï¼š`export TERM=xterm-256color`

### è¾“å‡ºè¿‡å¤š
- å‡å°‘ç”¨æˆ·æ•°é‡ï¼š`--n-users 2`
- å…³é—­ `--print` å‚æ•°
- ä½¿ç”¨ `tee` ä¿å­˜åˆ°æ–‡ä»¶ï¼š`python demo_logging.py | tee output.log`

## å¿«é€Ÿå‚è€ƒ

```bash
# åŸºç¡€ä½¿ç”¨ï¼ˆæœ‰æ—¥å¿—ï¼‰
python demo_logging.py

# è‡ªå®šä¹‰å‚æ•°ï¼ˆæœ‰æ—¥å¿—ï¼‰
python run_prism_pipeline.py --stage trace --print --n-users 3

# ä¿å­˜è¯¦ç»†è¿½è¸ª
python run_prism_pipeline.py --stage trace --print --save-detailed-traces

# æ‰¹é‡å®éªŒï¼ˆæ— æ—¥å¿—ï¼‰
python batch_runner.py --experiments standard

# å¸¦æ—¥å¿—çš„é…ç½®
python batch_runner.py --experiments quick_test_verbose
```

---

**æç¤º**ï¼šé¦–æ¬¡ä½¿ç”¨å»ºè®®è¿è¡Œ `python demo_logging.py` æŸ¥çœ‹å®Œæ•´çš„æ—¥å¿—è¾“å‡ºç¤ºä¾‹ï¼
